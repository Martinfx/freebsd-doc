-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

=============================================================================
FreeBSD-EN-25:13.wlan_tkip                                      Errata Notice
                                                          The FreeBSD Project

Topic:          net80211 TKIP crypto support fails for some drivers

Category:       core
Module:         wlan_tkip
Announced:      2025-08-08
Credits:        Adrian Chadd
Affects:        FreeBSD 14.3
Corrected:      2025-06-10 23:45:16 UTC (stable/14, 14.3-STABLE)
                2025-08-08 00:39:03 UTC (releng/14.3, 14.3-RELEASE-p2)

For general information regarding FreeBSD Errata Notices and Security
Advisories, including descriptions of the fields above, security
branches, and the following sections, please visit
<URL:https://security.FreeBSD.org/>.

I.   Background

In order to support Temporal Key Integrity Protocol (TKIP) on modern wireless
chipsets, the net80211 wireless stack was adjusted to skip certain crypto
operations if a driver indicated that they were already done by hardware.

II.  Problem Description

One adjustment erroneously changed a default for an operation from opt-in
to opt-out.

III. Impact

Older drivers may not pass flags to either opt-in or opt-out and thus
one TKIP operations is no longer executed for them given the changed
default.  This leads to non-working wireless connections.

IV.  Workaround

Users still using TKIP are highly advised to change their Cipher Suite
to CCMP as TKIP is no longer considered secure and has been deprecated
since 2012.

No other workaround is available.  Systems using CCMP are unaffected.

V.   Solution

Upgrade your system to a supported FreeBSD stable or release / security
branch (releng) dated after the correction date and reboot.

Perform one of the following:

1) To update your system via a binary patch:

Systems running a RELEASE version of FreeBSD on the amd64 or arm64 platforms,
can be updated via the freebsd-update(8) utility:

# freebsd-update fetch
# freebsd-update install
# shutdown -r +10min "Rebooting for erratum update"

2) To update your system via a source code patch:

The following patches have been verified to apply to the applicable
FreeBSD release branches.

a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.

# fetch https://security.FreeBSD.org/patches/EN-25:13/wlan_tkip.patch
# fetch https://security.FreeBSD.org/patches/EN-25:13/wlan_tkip.patch.asc
# gpg --verify wlan_tkip.patch.asc

b) Apply the patch.  Execute the following commands as root:

# cd /usr/src
# patch < /path/to/patch

c) Recompile your kernel as described in
<URL:https://www.FreeBSD.org/handbook/kernelconfig.html> and reboot the
system.

VI.  Correction details

This issue is corrected as of the corresponding Git commit hash in the
following stable and release branches:

Branch/path                             Hash                     Revision
- -------------------------------------------------------------------------
stable/14/                              950343a170f0    stable/14-n271651
releng/14.3/                            a3bd81ddfe29  releng/14.3-n271436
- -------------------------------------------------------------------------

Run the following command to see which files were modified by a
particular commit:

# git show --stat <commit hash>

Or visit the following URL, replacing NNNNNN with the hash:

<URL:https://cgit.freebsd.org/src/commit/?id=NNNNNN>

To determine the commit count in a working tree (for comparison against
nNNNNNN in the table above), run:

# git rev-list --count --first-parent HEAD

VII. References

<URL:https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=288009>

The latest revision of this advisory is available at
<URL:https://security.FreeBSD.org/advisories/FreeBSD-EN-25:13.wlan_tkip.asc>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEthUnfoEIffdcgYM7bljekB8AGu8FAmiVSh0ACgkQbljekB8A
Gu9d9BAAhaBGWImVR+mFeKhvJFJ01a47YpxVTyyfJR+Rd+4wF1Z9YZu1OcoZyMMQ
0vSkumjR98NeMFGpH9rZg2D6dJ4JQfvF+MbFlKlQ0QCdD8El++KM3T/S3h9WVXGp
Rs5in2XMxGj36LKNZ43Okmszh/JO6AiSLkfqkt708JiV+8Fff00JugFnU9ulQeDP
k3e5hw68ohS6DS5xrlmuY3yLzySl3PcI8vAp/8fY7cLchhJsPBmoWv87mParj6AG
uIlzJoQMFCVdlv2+e8p6be2Ua68f/qp6i1wgwUzLqLrirPUe74RlnU/+hkGRMYL+
+tkaPI/Bwdhn1xyybueBuGAJMiHi6iqlvmbORwxaTvuRZr2UTX/piCAMlWaiOlsu
REsVHc3d2bF6GkY7xx1TGYMI/+jx5Y5xrgXrpWZwcf8xzJxkMu+FOpOkzJEmqG3L
oDsvoCAOlck3/8+1R9nWMj36Q8HqhnJTr6axKNi7yRs5KC8BcTxjqM98eNSfurAe
pg818lA6xCEwgbc1M7kcVTAtQbaZUwSCaTbryr9EBBSIudVnsn7ZnrtT/yr/MLk8
/F4KDaPKXcbWYEPIFwIV0GKkMXVltD4O4cUPO1SSXmxcrMV+9mJ0xlKmQzbCD56y
6eFZsADV0l9mGYMv3LtODycbwAiL36F2JgTiNGLrPJbkAmy9foc=
=uFgf
-----END PGP SIGNATURE-----
